---
date: 2025-09-20 20:05:42
title: 封装集合类
permalink: /pages/af136d
categories:
  - src
  - 数据结构与算法
---
# 封装集合类

集合（Set）是一种包含不同元素的数据结构，它具有以下特性：
- 集合中的元素是唯一的，不存在重复值
- 集合没有特定的顺序
- 可以进行集合间的操作（如并集、交集、差集等）

在本文中，我们将使用JavaScript实现一个完整的集合类，并通过实例展示其应用。

## 一、集合类的基本实现

以下是基于JavaScript对象实现的集合类，包含了集合的常见操作：

```javascript
function Set() {
    // 属性 - 使用对象存储集合元素
    this.items = {}

    // 方法
    // 添加元素
    Set.prototype.add = function (value) {
        // 判断集合中是否已存在该元素
        if (this.has(value)) {
            return false
        }
        // 将元素添加到集合中（以值作为键和值）
        this.items[value] = value
        return true
    }

    // 判断元素是否存在
    Set.prototype.has = function (value) {
        return this.items.hasOwnProperty(value)
    }

    // 移除元素
    Set.prototype.remove = function (value) {
        // 判断集合中是否有该元素
        if (!this.has(value)) {
            return false
        }
        // 删除元素
        delete this.items[value]
        return true
    }

    // 清空集合
    Set.prototype.clear = function () {
        this.items = {}
    }

    // 获取集合大小
    Set.prototype.size = function () {
        return Object.keys(this.items).length
    }

    // 获取集合所有元素
    Set.prototype.values = function () {
        return Object.keys(this.items)
    }
}
```

## 二、集合的基本使用示例

让我们通过一些简单的例子来了解如何使用这个集合类：

```javascript
// 创建一个集合实例
let set = new Set()

// 添加元素
set.add('aaa')  // 返回 true，表示添加成功
set.add('bbb')  // 返回 true
set.add('aaa')  // 返回 false，因为 'aaa' 已经存在

// 判断元素是否存在
console.log(set.has('aaa'))  // 输出: true
console.log(set.has('ccc'))  // 输出: false

// 获取集合大小
console.log(set.size())  // 输出: 2

// 获取所有元素
console.log(set.values())  // 输出: ['aaa', 'bbb']

// 移除元素
set.remove('aaa')  // 返回 true，表示移除成功
console.log(set.has('aaa'))  // 输出: false
console.log(set.size())  // 输出: 1

// 清空集合
set.clear()
console.log(set.size())  // 输出: 0
```

## 三、集合间的操作

除了基本操作外，我们还可以实现集合间的常见操作，如并集、交集、差集和子集：

```javascript
// 并集 - 两个集合中所有元素的集合（不重复）
Set.prototype.union = function (otherSet) {
    // 创建一个新的集合用于存储结果
    let newSet = new Set()
    
    // 将当前集合的所有元素添加到新集合
    let values = this.values()
    for (let i = 0; i < values.length; i++) {
        newSet.add(values[i])  // 修复：原代码中误将 values[i] 放在数组中
    }
    
    // 将另一个集合的所有元素添加到新集合
    let otherValues = otherSet.values()
    for (let i = 0; i < otherValues.length; i++) {
        newSet.add(otherValues[i])
    }
    
    return newSet
}

// 交集 - 两个集合中共有的元素
Set.prototype.intersection = function (otherSet) {
    let intersectionSet = new Set()
    let values = this.values()
    
    for (let i = 0; i < values.length; i++) {
        if (otherSet.has(values[i])) {
            intersectionSet.add(values[i])
        }
    }
    
    return intersectionSet
}

// 差集 - 存在于当前集合但不存在于另一个集合的元素
Set.prototype.difference = function (otherSet) {
    let difference = new Set()
    let values = this.values()
    
    for (let i = 0; i < values.length; i++) {
        if (!otherSet.has(values[i])) {
            difference.add(values[i])
        }
    }
    
    return difference
}

// 子集 - 判断当前集合是否是另一个集合的子集
Set.prototype.subset = function (otherSet) {
    // 修复：原方法名 pubset 改为更标准的 subset
    if (this.size() > otherSet.size()) {
        return false  // 如果当前集合大小大于另一个集合，不可能是子集
    }
    
    let values = this.values()
    for (let i = 0; i < values.length; i++) {
        if (!otherSet.has(values[i])) {
            return false
        }
    }
    
    return true
}
```

## 四、集合间操作的使用示例

让我们通过一个示例来展示集合间的操作：

```javascript
// 创建两个集合
let setA = new Set()
setA.add('aaa')
setA.add('bbb')
setA.add('ccc')
setA.add('ddd')

let setB = new Set()
setB.add('bbb')
setB.add('ccc')
setB.add('eee')
setB.add('fff')

// 并集操作
let unionSet = setA.union(setB)
console.log('并集:', unionSet.values())  // 输出: ['aaa', 'bbb', 'ccc', 'ddd', 'eee', 'fff']

// 交集操作
let intersectionSet = setA.intersection(setB)
console.log('交集:', intersectionSet.values())  // 输出: ['bbb', 'ccc']

// 差集操作
let differenceSet = setA.difference(setB)
console.log('差集:', differenceSet.values())  // 输出: ['aaa', 'ddd']

// 子集操作
let setC = new Set()
setC.add('bbb')
setC.add('ccc')
console.log('setC是否是setA的子集:', setC.subset(setA))  // 输出: true
console.log('setA是否是setC的子集:', setA.subset(setC))  // 输出: false
```

## 五、算法原理解析

### 1. 集合的基本原理

集合是数学中的一个基本概念，我们在这里使用JavaScript对象来实现集合。对象的属性是唯一的，这正好符合集合元素唯一的特性。

### 2. 各方法的实现原理

- **add方法**：首先检查元素是否已存在，如不存在则添加
- **has方法**：使用`hasOwnProperty`检查元素是否存在
- **remove方法**：先检查元素是否存在，如存在则删除
- **size方法**：使用`Object.keys`获取所有属性名并返回其长度
- **values方法**：直接返回所有属性名组成的数组

### 3. 集合间操作的实现原理

- **并集**：创建一个新集合，将两个集合的所有元素添加进去（利用集合自动去重的特性）
- **交集**：遍历第一个集合的所有元素，检查是否也存在于第二个集合中
- **差集**：遍历第一个集合的所有元素，检查是否不存在于第二个集合中
- **子集**：遍历第一个集合的所有元素，检查是否都存在于第二个集合中

## 六、性能分析

- **空间复杂度**：O(n)，其中n是集合中元素的数量
- **时间复杂度**：
  - add、has、remove方法：平均O(1)
  - size、values方法：O(n)
  - union、intersection、difference、subset方法：O(n)

## 七、ES6版本的集合实现

JavaScript的ES6版本已经内置了Set类，我们可以直接使用它：

```javascript
// ES6 Set的基本使用
let es6Set = new Set()

// 添加元素
es6Set.add('aaa')
es6Set.add('bbb')
es6Set.add('ccc')

// 判断元素是否存在
console.log(es6Set.has('aaa'))  // 输出: true

// 获取集合大小
console.log(es6Set.size)  // 输出: 3（注意是属性而不是方法）

// 遍历集合
es6Set.forEach(value => console.log(value))
// 输出:
// aaa
// bbb
// ccc

// 转换为数组
let arr = Array.from(es6Set)
console.log(arr)  // 输出: ['aaa', 'bbb', 'ccc']

// ES6 Set也支持集合间的操作，但需要自己实现
// 并集
function union(setA, setB) {
    let unionSet = new Set(setA)
    for (let elem of setB) {
        unionSet.add(elem)
    }
    return unionSet
}

// 交集
function intersection(setA, setB) {
    let intersectionSet = new Set()
    for (let elem of setB) {
        if (setA.has(elem)) {
            intersectionSet.add(elem)
        }
    }
    return intersectionSet
}

// 差集
function difference(setA, setB) {
    let differenceSet = new Set(setA)
    for (let elem of setB) {
        differenceSet.delete(elem)
    }
    return differenceSet
}

// 子集
function subset(setA, setB) {
    if (setA.size > setB.size) {
        return false
    }
    for (let elem of setA) {
        if (!setB.has(elem)) {
            return false
        }
    }
    return true
}
```

## 八、集合的实际应用场景

1. **数据去重**：可以快速去除数组中的重复元素
2. **关系判断**：可以用来表示和判断两个集合之间的关系（如共同好友、相似兴趣等）
3. **权限控制**：可以表示用户的权限集合，方便进行权限判断
4. **网络爬虫**：可以用来记录已爬取的URL，避免重复爬取

通过以上的实现和示例，我们已经全面了解了集合的基本概念、实现方法和应用场景。集合是一种非常实用的数据结构，在实际开发中经常会用到。

