---
date: 2025-10-03 10:36:17
title: CSS选择器权重详解
permalink: /pages/3da370
categories:
  - src
  - css
---

# CSS选择器权重详解

在CSS中，当多个规则应用于同一个元素时，浏览器需要决定哪个规则优先应用。这个决定基于选择器的权重（Specificity）。

## 权重计算规则

CSS选择器权重用一个三维向量 (x, y, z) 表示：

- **x**：ID选择器的数量
- **y**：类选择器、属性选择器、伪类选择器的数量
- **z**：元素选择器、伪元素选择器的数量

> 注意：通配符选择器 `*` 不影响权重

## 权重比较规则

1. 首先比较 x 值，x 值大的权重高
2. 如果 x 值相同，比较 y 值，y 值大的权重高
3. 如果 y 值也相同，比较 z 值，z 值大的权重高
4. 如果都相同，则后定义的样式覆盖先定义的样式

## 选择器权重示例

### 基础选择器权重

| 选择器 | 权重 (x,y,z) | 示例 |
|--------|--------------|------|
| 元素选择器 | (0,0,1) | `div`, `p`, `span` |
| 类选择器 | (0,1,0) | `.container`, `.btn` |
| ID选择器 | (1,0,0) | `#header`, `#main` |
| 内联样式 | (1,0,0,0) | `style="color: red"` |

### 复合选择器权重

```css
/* 权重: (0,0,1) */
p { color: red; }

/* 权重: (0,1,0) - 覆盖上面的规则 */
.text { color: blue; }

/* 权重: (0,1,1) - 覆盖上面的规则 */
p.text { color: green; }

/* 权重: (1,0,0) - 覆盖上面的规则 */
#main { color: purple; }

/* 权重: (1,1,1) - 覆盖上面的规则 */
#main p.text { color: orange; }
```

### 属性选择器和伪类选择器

```css
/* 权重: (0,1,0) */
[type="text"] { border: 1px solid #ccc; }

/* 权重: (0,1,0) */
:hover { background-color: #f5f5f5; }

/* 权重: (0,2,0) - 覆盖上面的规则 */
.input:focus { border-color: #007bff; }
```

### 伪元素选择器

```css
/* 权重: (0,0,1) */
p::first-line { font-weight: bold; }

/* 权重: (0,1,1) - 覆盖上面的规则 */
.quote::first-line { color: #666; }
```

## 特殊情况

### !important 声明

`!important` 声明会覆盖正常的权重计算，但应谨慎使用：

```css
/* 即使权重较低，也会覆盖其他规则 */
.text { color: red !important; }

/* 即使是ID选择器也无法覆盖 */
#main { color: blue; }
```

### 继承的样式

继承的样式没有权重，任何直接应用的样式都会覆盖继承的样式：

```css
/* 父元素样式 */
.parent { color: red; }

/* 子元素继承 color: red */

/* 直接应用的样式会覆盖继承的样式 */
.child { color: blue; } /* 权重: (0,0,1) */
```

## 实际应用示例

### 示例1：导航菜单样式

```html
<ul id="main-nav" class="nav">
  <li class="nav-item"><a href="#" class="nav-link active">首页</a></li>
  <li class="nav-item"><a href="#" class="nav-link">关于</a></li>
</ul>
```

```css
/* 权重: (0,1,0) */
.nav-link {
  color: #333;
  text-decoration: none;
}

/* 权重: (0,2,0) - 覆盖上面的规则 */
.nav-link.active {
  color: #007bff;
  font-weight: bold;
}

/* 权重: (1,1,1) - 覆盖上面的规则 */
#main-nav .nav-link {
  padding: 10px 15px;
}
```

### 示例2：表单样式

```html
<form id="contact-form">
  <input type="text" class="form-control" placeholder="姓名">
  <input type="email" class="form-control error" placeholder="邮箱">
</form>
```

```css
/* 权重: (0,1,0) */
.form-control {
  border: 1px solid #ccc;
  padding: 8px;
}

/* 权重: (0,2,0) - 覆盖上面的规则 */
.form-control.error {
  border-color: #dc3545;
  background-color: #f8d7da;
}

/* 权重: (1,1,1) - 覆盖上面的规则 */
#contact-form .form-control {
  width: 100%;
  margin-bottom: 10px;
}
```

## 最佳实践

1. **避免过度使用ID选择器**：ID选择器权重很高，可能导致样式难以覆盖
2. **使用类选择器为主**：类选择器提供了良好的权重平衡和复用性
3. **谨慎使用!important**：只在必要时使用，避免破坏正常的权重机制
4. **保持选择器简洁**：避免过深的嵌套选择器，提高性能和可维护性
5. **合理使用语义化类名**：提高代码可读性和维护性

通过理解CSS选择器权重机制，可以更好地控制样式的优先级，避免样式冲突，编写更可维护的CSS代码。
